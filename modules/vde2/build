
# -*- mode: shell-script;  -*-

set -e

ORIGIN="http://downloads.sourceforge.net/project/vde/vde2/2.3.2/vde2-2.3.2.tar.gz"
MD5=d3f3e979558e396b8405c4613df9dfa0


parse_inputs

build_steps=(
    "true"
    "rm -rf source root && mkdir -p source root"
    "tar -xzvf $(get_md5_path $MD5) -C source"
    "echo pwd is $(pwd)"
    "cd source/vde2-2.3.2"
#    "autoreconf -fi"
    "./configure --prefix=$(pwd)/root --enable-experimental"
    "make && make install "
)

build_checks=(
    "test -f root/bin/vdecmd"
)

spot_checks=(
    "true"
)

debug "calling get for vde2 source"
get --origin $ORIGIN --md5 $MD5

debug "calling build for vde2 source"
build --build-steps build_steps[@] \
      --build-checks build_checks[@] \
      --spot-checks spot_checks[@] \
      --md5 $MD5
